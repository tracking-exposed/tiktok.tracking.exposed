---
title: Query comparison page
subtitle: Every search query collected by tiktok.tracking.exposed goes here
date: 2021-09-10T05:01:21+01:00
draft: false
extraCSS: "/css/search.css"
type: app 
---

<div id="initially--hidden" hidden>

  <div class="row">
    <div class="col-3 monospace">
      <a title="back to query list" href="/queries">⬅️</a>
      Search results for:
    </div>
    <div class="col-5 monospace" id="subject">
    </div>
    <div class="col-3 text-right monospace">
      <a id="repeat" target=_blank>repeat on tiktok</a>
    </div>
    <div class="col-1 monospace">
      <a id="csv">⬇️CSV</a>
    </div>
  </div>

  <hr/>

</div>

<div id="evidence--list"></div>

<!--
<link href="/css/c3.min.css" rel="stylesheet">
<script src="/js/d3.min.js"></script>
<script src="/js/c3.min.js"></script>
-->

<script type="text/javascript" src="/js/global.js"></script>
<script type="text/javascript" src="/js/search.js"></script>
<script type="text/javascript">

  $(document).ready(async function() {
    const term = window.location.hash.substr(1);
    const url = buildApiUrl('public/query', term + '/json', 2);
    const response = await fetch(url);
    const data = await response.json();
    console.log(data);
    if(!data.length) {
        $("#evidence--list")
          .html('<span class="error">Error: no data found matching this query</span>')
        return;
    }
    $("#initially--hidden").removeAttr('hidden');
    $("#subject").text(decodeURI(term));
    $("#repeat").attr('href', 'https://www.tiktok.com/search?q=' + term);
    $("#csv").on('click', function() {
        const csvurl = buildApiUrl('public/query', term + '/csv', 2);
        window.location = csvurl;
    })
    const html = _.map(data, produceSearchEntry).join('\n');
    $("#evidence--list").html(html);

  });

</script>
